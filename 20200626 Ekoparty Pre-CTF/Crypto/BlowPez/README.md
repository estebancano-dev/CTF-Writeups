> Decrypt the flag! The web source has the key. k2KBEayCajXh0hzoxO5Mp3x8kheeopN9

Un hint de este reto es el titulo
>BlowPez

es el cifrado [BlowFish](https://es.wikipedia.org/wiki/Blowfish "BlowFish"), solo que tradujeron Fish por Pez

Otro hint es 
>"The web source has the key".

Buscando a ojo, en el fuente no hay un pomo. Utilizo este codigo en PHP y el diccionario rockyou para ver si encuentra la key

```php
<?php
	set_time_limit(0);
	function decrypt($key, $data) {
		$l = strlen($key);
		if ($l < 16) {
			$key = str_repeat($key, ceil(16 / $l));
		}
		$val = openssl_decrypt($data, 'BF-ECB', $key, OPENSSL_RAW_DATA | OPENSSL_NO_PADDING);
		return $val;
	}
	$handle = fopen("rockyou.txt", "r");
	while (($line = fgets($handle)) !== false) {
		$asd = decrypt(($line), $data);
		if (substr($asd, 0, 4) === 'EKO{') {
			echo $asd . " --- " . $line . "<br>";
			die;
		}
	}
	fclose($handle);
	echo "nada";
```

No encontró nada! Para esta altura, ya habia probado quichicientos diccionarios sin suerte, y me empecé a enroscar con el hint, a ver si era el codigo fuente de ekoparty o
era otra cosa que me estaba pasando por alto

Usando el codigo fuente de nuevo, pense en tomar de a 1 caracter, de a 2, 3, etc y probar todas esas claves. No funcionó. Que pasa entonces si comienzo del segundo caracter del fuente? Lo mismo, tomo de a 1, 2, 3 etc y voy probando.

```php
<?php

set_time_limit(0);

function decrypt($key, $data) {
	$l = strlen($key);
	if ($l < 16) {
		$key = str_repeat($key, ceil(16 / $l));
	}
	$val = openssl_decrypt($data, 'BF-ECB', $key, OPENSSL_RAW_DATA | OPENSSL_NO_PADDING);
	return $val;
}

$data = base64_decode('k2KBEayCajXh0hzoxO5Mp3x8kheeopN9');
$desde = 0;
$d = $largo = 1;//$d es el offset desde donde comienzo a seleccion caracteres. $largo es el largo de la key a extraer
$htmlencoded = 'DQo8IURPQ1RZUEUgaHRtbD4NCjxodG1sIGxhbmc9ImVuIj4NCiAgICA8aGVhZD4NCiAgICAgICAgPG1ldGEgY2hhcnNldD0idXRmLTgiPg0KICAgICAgICA8bWV0YSBodHRwLWVxdWl2PSJYLVVBLUNvbXBhdGlibGUiIGNvbnRlbnQ9IklFPWVkZ2UiPg0KICAgICAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEsIG1heGltdW0tc2NhbGU9MSwgdXNlci1zY2FsYWJsZT1ubyI+DQogICAgICAgIDxtZXRhIG5hbWU9ImRlc2NyaXB0aW9uIiBjb250ZW50PSJFS09QQVJUWSAyMDIwIj4NCiAgICAgICAgPG1ldGEgbmFtZT0iYXV0aG9yIiBjb250ZW50PSJUSVRBTiBTRUNVUklUWSI+DQogICAgICAgIDxtZXRhIG5hbWU9InRoZW1lLWNvbG9yIiBjb250ZW50PSIjMTAxMDEwIj4NCiAgICAgICAgPHNjcmlwdCBzcmM9Ii9zdGF0aWMvanMvanF1ZXJ5LTMuMi4xLm1pbi5qcyI+PC9zY3JpcHQ+DQogICAgICAgIDxzY3JpcHQgc3JjPSIvc3RhdGljL2pzL3RldGhlci5taW4uanMiPjwvc2NyaXB0Pg0KICAgICAgICA8c2NyaXB0IHNyYz0iL3N0YXRpYy9qcy9wb3BwZXIubWluLmpzIj48L3NjcmlwdD4NCiAgICAgICAgPHNjcmlwdCBzcmM9Ii9zdGF0aWMvanMvYm9vdHN0cmFwLm1pbi5qcyI+PC9zY3JpcHQ+DQogICAgICAgIDxzY3JpcHQgc3JjPSIvc3RhdGljL2pzL3N3ZWV0YWxlcnQyLm1pbi5qcyI+PC9zY3JpcHQ+DQogICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iL3N0YXRpYy9jc3Mvc3dlZXRhbGVydDIubWluLmNzcyIgdHlwZT0idGV4dC9jc3MiIC8+DQogICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iL3N0YXRpYy9jc3MvYm9vdHN0cmFwLm1pbi5jc3MiIHR5cGU9InRleHQvY3NzIi8+DQogICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iL3N0YXRpYy9jc3MvY3RmLm1pbi5jc3MiIHR5cGU9InRleHQvY3NzIi8+DQogICAgICAgIDxsaW5rIHJlbD0ic2hvcnRjdXQgaWNvbiIgaHJlZj0iL3N0YXRpYy9pbWcvZWtvcGFydHktbG9nby5wbmciPg0KICAgICAgICA8c3R5bGU+DQogICAgICAgIC5uYXZiYXJ7cGFkZGluZzo1cHggMTZweCA1cHggMTZweDt9DQogICAgICAgIDwvc3R5bGU+DQogICAgICAgIA0KICAgICAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii9zdGF0aWMvY3NzL3JlbW9kYWwubWluLmNzcyIgdHlwZT0idGV4dC9jc3MiLz4NCiAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIvc3RhdGljL2Nzcy9yZW1vZGFsLWRlZmF1bHQtdGhlbWUubWluLmNzcyIgdHlwZT0idGV4dC9jc3MiLz4NCiAgICAgICAgPHNjcmlwdCBzcmM9Ii9zdGF0aWMvanMvdGFza3MubWluLmpzIiB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnPjwvc2NyaXB0Pg0KICAgICAgICA8c2NyaXB0IHNyYz0iL3N0YXRpYy9qcy9yZW1vZGFsLm1pbi5qcyIgdHlwZT0ndGV4dC9qYXZhc2NyaXB0Jz48L3NjcmlwdD4NCiAgICAgICAgPHN0eWxlPg0KICAgICAgICBAbWVkaWEobWluLXdpZHRoOiAxMjAwcHgpey5jb250YWluZXJ7d2lkdGg6MTQ0MHB4O21heC13aWR0aDoxMDAlfS5jb2wtbWQtMnstd2Via2l0LWJveC1mbGV4OjA7LXdlYmtpdC1mbGV4OjAgMCAxMiU7LW1zLWZsZXg6MCAwIDEyJTtmbGV4OjAgMCAxMiU7bWF4LXdpZHRoOiAxMiV9fQ0KICAgICAgICAuc29sdmVke2JhY2tncm91bmQtY29sb3I6IHJnYmEoMzksMTc0LDk2LDAuMSk7Y29sb3I6ICMyN2FlNjA7fQ0KICAgICAgICAubm90c29sdmVke2JhY2tncm91bmQtY29sb3I6IHJnYmEoMTkyLDU3LDQzLDAuMSk7Y29sb3I6ICNjMDM5MmI7fQ0KICAgICAgICA8L3N0eWxlPg0KICAgICAgICANCiAgICAgICAgDQogICAgICAgIDx0aXRsZT5la29wYXJ0eSAyMDIwPC90aXRsZT4NCiAgICAgICAgDQogICAgICAgIDxzY3JpcHQ+DQogICAgICAgICAgICAkKGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIGNvZGUgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3Vic3RyKDEsIDMpOw0KICAgICAgICAgICAgICAgIHN3aXRjaCAoY29kZSkgew0KICAgICAgICAgICAgICAgICAgICBjYXNlICdydWwnOiQoJyNuYXYtcnVsZXMnKS5hZGRDbGFzcygnYWN0aXZlJyk7YnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJ25ldyc6JCgnI25hdi1uZXdzJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO2JyZWFrOw0KICAgICAgICAgICAgICAgICAgICBjYXNlICdsb2cnOiQoJyNuYXYtbG9naW4nKS5hZGRDbGFzcygnYWN0aXZlJyk7YnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Rhcyc6JCgnI25hdi10YXNrcycpLmFkZENsYXNzKCdhY3RpdmUnKTticmVhazsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAncmVnJzokKCcjbmF2LXJlZ2lzdGVyJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO2JyZWFrOw0KICAgICAgICAgICAgICAgICAgICBjYXNlICdzY28nOiQoJyNuYXYtc2NvcmVib2FyZCcpLmFkZENsYXNzKCdhY3RpdmUnKTticmVhazsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAndGVhJzokKCcjbmF2LXRlYW1zJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO2JyZWFrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICA8L3NjcmlwdD4NCiAgICA8L2hlYWQ+DQogICAgPGJvZHk+DQogICAgICAgIDxkaXYgaWQ9ImJhY2tncm91bmQtaW1hZ2UiPjwvZGl2Pg0KDQogICAgICAgIDxkaXYgY2xhc3M9Im5hdmJhciBuYXZiYXItZXhwYW5kLWxnIGZpeGVkLXRvcCBuYXZiYXItZGFyayBuYXZiYXItZml4ZWQtdG9wIGJnLXByaW1hcnkiPg0KICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ibmF2YmFyLXRvZ2dsZXIgbmF2YmFyLXRvZ2dsZXItcmlnaHQiIHR5cGU9ImJ1dHRvbiIgZGF0YS10b2dnbGU9ImNvbGxhcHNlIiBkYXRhLXRhcmdldD0iI25hdmJhckNvbGxhcHNlIiBhcmlhLWNvbnRyb2xzPSJuYXZiYXJDb2xsYXBzZSIgYXJpYS1leHBhbmRlZD0iZmFsc2UiIGFyaWEtbGFiZWw9IlRvZ2dsZSBuYXZpZ2F0aW9uIj4NCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibmF2YmFyLXRvZ2dsZXItaWNvbiI+PC9zcGFuPg0KICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICANCiAgICAgICAgICAgIDxhIGNsYXNzPSJuYXZiYXItYnJhbmQiIGhyZWY9Ii8iPg0KICAgICAgICAgICAgPGltZyBzcmM9Ii9zdGF0aWMvaW1nL2Vrb3BhcnR5LWxvZ28ucG5nIiB3aWR0aD0iNDBweCIgY2xhc3M9ImQtaW5saW5lLWJsb2NrIGFsaWduLW1pZGRsZSIgYWx0PSIiIHN0eWxlPSJtYXJnaW46M3B4IDEwcHggMCAwOyI+IGVrb3BhcnR5IDIwMjANCiAgICAgICAgICAgIDwvYT4NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibmF2YmFyLWNvbGxhcHNlIGNvbGxhcHNlIiBpZD0ibmF2YmFyQ29sbGFwc2UiPg0KICAgICAgICAgICAgICA8dWwgY2xhc3M9Im5hdmJhci1uYXYgbXItYXV0byI+DQogICAgICAgICAgICAgICAgPGxpIGNsYXNzPSJuYXYtaXRlbSIgaWQ9Im5hdi10YXNrcyI+PGEgY2xhc3M9Im5hdi1saW5rIiBocmVmPSIvdGFza3MiPlRhc2tzPC9hPjwvbGk+DQogICAgICAgICAgICAgICAgPGxpIGNsYXNzPSJuYXYtaXRlbSIgaWQ9Im5hdi1uZXdzIj48YSBjbGFzcz0ibmF2LWxpbmsiIGhyZWY9Ii9uZXdzIj5OZXdzPC9hPjwvbGk+DQogICAgICAgICAgICAgICAgPGxpIGNsYXNzPSJuYXYtaXRlbSIgaWQ9Im5hdi1ydWxlcyI+PGEgY2xhc3M9Im5hdi1saW5rIiBocmVmPSIvcnVsZXMiPlJ1bGVzPC9hPjwvbGk+DQogICAgICAgICAgICAgICAgPGxpIGNsYXNzPSJuYXYtaXRlbSIgaWQ9Im5hdi1zY29yZWJvYXJkIj48YSBjbGFzcz0ibmF2LWxpbmsiIGhyZWY9Ii9zY29yZWJvYXJkIj5TY29yZWJvYXJkPC9hPjwvbGk+DQogICAgICAgICAgICAgIDwvdWw+DQogICAgICAgICAgICAgIDx1bCBjbGFzcz0ibmF2IG5hdmJhci1uYXYgbWwtYXV0byI+DQogICAgICAgICAgICAgICAgPGxpIGNsYXNzPSJuYXYtaXRlbSI+TG9nZ2VkIGluIGFzIGZlcm5ldEluamVjdGlvbjwvc3Bhbj4gPGltZyBzcmM9Ii9zdGF0aWMvaW1nL2ZsYWdzL0FSRy5wbmciIGFsdD0iQVJHIiAvPiZuYnNwOyZuYnNwOzxhIGhyZWY9Ii9sb2dvdXQiPjxzcGFuIGNsYXNzPSJnbHlwaGljb24gZ2x5cGhpY29uLW9mZiI+PC9zcGFuPjwvYT48L2xpPg0KICAgICAgICAgICAgICA8L3VsPg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICANCiAgICAgICAgPC9kaXY+DQogICAgICAgIA0KICAgICAgICA8ZGl2IGNsYXNzPSJjb250YWluZXItZmx1aWQiPg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0icm93IHJvdy1mdWxsLWhlaWdodCBuby1ndXR0ZXJzIj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wiPjwvZGl2Pg0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC05IiBpZD0idGFza3MiPg0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC0zIGQtbm9uZSBkLW1kLWJsb2NrIj48ZGl2IHN0eWxlPSJwb3NpdGlvbjpmaXhlZDt3aWR0aDoyMyU7bWF4LXdpZHRoOjIwJSI+PHNjcmlwdCBzcmM9Ii9zdGF0aWMvanMvanF1ZXJ5LmNvdW50ZG93bi5taW4uanMiIGNyb3Nzb3JpZ2luPSJhbm9ueW1vdXMiPjwvc2NyaXB0Pg0KPHNjcmlwdCBzcmM9Ii9zdGF0aWMvanMvbW9tZW50Lm1pbi5qcyIgY3Jvc3NvcmlnaW49ImFub255bW91cyI+PC9zY3JpcHQ+DQo8c2NyaXB0Pg0KJChmdW5jdGlvbigpIHsNCiAgICB2YXIgZW5kX3RpbWUgPSBtb21lbnQudXRjKFsyMDIwLCA3LCAyNywgMCwgMCwgMCwgMF0pOw0KICAgIHZhciBuZXh0X3RpbWUgPSBtb21lbnQudXRjKFsyMDIwLCA3LCAyMiwgMCwgMCwgMCwgMF0pOw0KICAgICQoIiNlbmRfdGltZSIpLmNvdW50ZG93bihlbmRfdGltZS50b0RhdGUoKSwgZnVuY3Rpb24oZXZlbnQpIHsNCiAgICAgICAgJCgnI2VfZGF5cycpLnRleHQoZXZlbnQuc3RyZnRpbWUoJyVEJykpOw0KICAgICAgICAkKCcjZV9ob3VycycpLnRleHQoZXZlbnQuc3RyZnRpbWUoJyVIJykpOw0KICAgICAgICAkKCcjZV9taW51dGVzJykudGV4dChldmVudC5zdHJmdGltZSgnJU0nKSk7DQogICAgICAgICQoJyNlX3NlY29uZHMnKS50ZXh0KGV2ZW50LnN0cmZ0aW1lKCclUycpKTsNCiAgICB9KTsNCiAgICAkKCIjbmV4dF90aW1lIikuY291bnRkb3duKG5leHRfdGltZS50b0RhdGUoKSwgZnVuY3Rpb24oZXZlbnQpIHsNCiAgICAgICAgJCgnI25fZGF5cycpLnRleHQoaXNOYU4oZXZlbnQuc3RyZnRpbWUoJyVEJykpPyctJzpldmVudC5zdHJmdGltZSgnJUQnKSk7DQogICAgICAgICQoJyNuX2hvdXJzJykudGV4dChpc05hTihldmVudC5zdHJmdGltZSgnJUgnKSk/Jy0nOmV2ZW50LnN0cmZ0aW1lKCclSCcpKTsNCiAgICAgICAgJCgnI25fbWludXRlcycpLnRleHQoaXNOYU4oZXZlbnQuc3RyZnRpbWUoJyVNJykpPyctJzpldmVudC5zdHJmdGltZSgnJU0nKSk7DQogICAgICAgICQoJyNuX3NlY29uZHMnKS50ZXh0KGlzTmFOKGV2ZW50LnN0cmZ0aW1lKCclUycpKT8nLSc6ZXZlbnQuc3RyZnRpbWUoJyVTJykpOw0KICAgIH0pOw0KfSk7DQo8L3NjcmlwdD4NCjxjZW50ZXI+PGgxPjxzcGFuIGNsYXNzPSJnbGl0Y2giPlRIRSBFTkQ8L3NwYW4+PC9oMT48L2NlbnRlcj4NCjxkaXYgY2xhc3M9InRpbWVyIj4NCiAgICA8ZGl2IGlkPSJlbmRfdGltZSI+DQogICAgICAgIDxzcGFuIGNsYXNzPSJ0YXNrcy1jb3VudGRvd24tcm93Ij4NCiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0YXNrcy1jb3VudGRvd24tc2VjdGlvbiI+DQogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRhc2tzLWNvdW50ZG93bi1hbW91bnQiIGlkPSJlX2RheXMiPjwvc3Bhbj4NCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iY291bnRkb3duLXBlcmlvZCI+RGF5czwvc3Bhbj4NCiAgICAgICAgICAgIDwvc3Bhbj4NCiAgICAgICAgDQogICAgICAgICAgICA8c3BhbiBjbGFzcz0idGFza3MtY291bnRkb3duLXNlY3Rpb24iPg0KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0YXNrcy1jb3VudGRvd24tYW1vdW50IiBpZD0iZV9ob3VycyI+PC9zcGFuPg0KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJjb3VudGRvd24tcGVyaW9kIj5Ib3Vyczwvc3Bhbj4NCiAgICAgICAgICAgIDwvc3Bhbj4NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRhc2tzLWNvdW50ZG93bi1zZWN0aW9uIj4NCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idGFza3MtY291bnRkb3duLWFtb3VudCIgaWQ9ImVfbWludXRlcyI+PC9zcGFuPg0KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJjb3VudGRvd24tcGVyaW9kIj5NaW51dGVzPC9zcGFuPg0KICAgICAgICAgICAgPC9zcGFuPg0KDQogICAgICAgICAgICA8c3BhbiBjbGFzcz0idGFza3MtY291bnRkb3duLXNlY3Rpb24iPg0KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0YXNrcy1jb3VudGRvd24tYW1vdW50IiBpZD0iZV9zZWNvbmRzIj48L3NwYW4+DQogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9ImNvdW50ZG93bi1wZXJpb2QiPlNlY29uZHM8L3NwYW4+DQogICAgICAgICAgICA8L3NwYW4+DQogICAgICAgIDwvc3Bhbj4NCiAgICA8L2Rpdj4NCjwvZGl2Pjxici8+DQo8Y2VudGVyPjxoMT48c3BhbiBjbGFzcz0iZ2xpdGNoIj5ORVhUIENIQUxMPC9zcGFuPjwvaDE+PC9jZW50ZXI+DQo8ZGl2IGNsYXNzPSJ0aW1lciI+DQogICAgPGRpdiBpZD0ibmV4dF90aW1lIj4NCiAgICAgICAgPHNwYW4gY2xhc3M9InRhc2tzLWNvdW50ZG93bi1yb3ciPg0KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRhc2tzLWNvdW50ZG93bi1zZWN0aW9uIj4NCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idGFza3MtY291bnRkb3duLWFtb3VudCIgaWQ9Im5fZGF5cyI+PC9zcGFuPg0KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJjb3VudGRvd24tcGVyaW9kIj5EYXlzPC9zcGFuPg0KICAgICAgICAgICAgPC9zcGFuPg0KICAgICAgICANCiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0YXNrcy1jb3VudGRvd24tc2VjdGlvbiI+DQogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRhc2tzLWNvdW50ZG93bi1hbW91bnQiIGlkPSJuX2hvdXJzIj48L3NwYW4+DQogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9ImNvdW50ZG93bi1wZXJpb2QiPkhvdXJzPC9zcGFuPg0KICAgICAgICAgICAgPC9zcGFuPg0KICAgICAgICAgICAgDQogICAgICAgICAgICA8c3BhbiBjbGFzcz0idGFza3MtY291bnRkb3duLXNlY3Rpb24iPg0KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0YXNrcy1jb3VudGRvd24tYW1vdW50IiBpZD0ibl9taW51dGVzIj48L3NwYW4+DQogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9ImNvdW50ZG93bi1wZXJpb2QiPk1pbnV0ZXM8L3NwYW4+DQogICAgICAgICAgICA8L3NwYW4+DQoNCiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0YXNrcy1jb3VudGRvd24tc2VjdGlvbiI+DQogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRhc2tzLWNvdW50ZG93bi1hbW91bnQiIGlkPSJuX3NlY29uZHMiPjwvc3Bhbj4NCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iY291bnRkb3duLXBlcmlvZCI+U2Vjb25kczwvc3Bhbj4NCiAgICAgICAgICAgIDwvc3Bhbj4NCiAgICAgICAgPC9zcGFuPg0KICAgIDwvZGl2Pg0KPC9kaXY+PGJyLz4NCjxjZW50ZXI+PGgxPjxzcGFuIGNsYXNzPSJnbGl0Y2giPlRPUCA1PC9zcGFuPjwvaDE+PC9jZW50ZXI+DQo8dGFibGUgaWQ9InNjb3JlYm9hcmQiIGNsYXNzPSJ0YWJsZSB0YWJsZS1zdHJpcGVkIHNjb3JlLXJpZ2h0IHRhYmxlLXRvcDEwIj48L3RhYmxlPjwvZGl2PjwvZGl2Pg0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICANCiAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgPGZvb3RlciBjbGFzcz0iZm9vdGVyIG5hdmJhciBuYXZiYXItZGFyayBiZy1wcmltYXJ5Ij4NCgkgIDxkaXYgY2xhc3M9InctMTAwIGQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtYmV0d2VlbiI+DQoJICAgIDxkaXY+DQogICAgICAgICAgICAJPGEgaHJlZj0iaHR0cHM6Ly9udWxsLWxpZmUuY29tIiB0YXJnZXQ9ImJsYW5rIj48aW1nIHNyYz0iL3N0YXRpYy9pbWcvbnVsbC5wbmciIHN0eWxlPSJtYXJnaW46M3B4IDI1cHggMCAwOy13ZWJraXQtZmlsdGVyOiBncmF5c2NhbGUoMTAwJSk7ZmlsdGVyOiBncmF5c2NhbGUoMTAwJSk7IiB3aWR0aD0iNjVweDsiIGFsdD0iTlVMTCBMaWZlIGxvZ28iPjwvYT4NCgkgICAgPC9kaXY+DQogICAgICAgIA0KCSAgICA8ZGl2Pg0KICAgICAgICAgICAgCTxhIGhyZWY9Imh0dHBzOi8vc2VjdXJpdHlsYWIuZ2l0aHViLmNvbS8iIHRhcmdldD0iYmxhbmsiPjxpbWcgc3JjPSIvc3RhdGljL2ltZy9naXRodWIucG5nIiBzdHlsZT0ibWFyZ2luOjNweCAyNXB4IDAgMDstd2Via2l0LWZpbHRlcjogYnJpZ2h0bmVzcygwKSBpbnZlcnQoMSk7ZmlsdGVyOiBicmlnaHRuZXNzKDApIGludmVydCgxKTsiIHdpZHRoPSIxNDBweDsiIGFsdD0iR2l0aHViIFNlY3VyaXR5IExhYiI+PC9hPg0KCSAgICA8L2Rpdj4NCiAgICAgICAgDQogICAgICAgICAgICA8ZGl2Pg0KCQk8YSBocmVmPSJodHRwczovL3RpdGFuLmNvIiB0YXJnZXQ9ImJsYW5rIj48aW1nIHNyYz0iL3N0YXRpYy9pbWcvbG9nby5wbmciIHN0eWxlPSJtYXJnaW46M3B4IDI1cHggMCAwOy13ZWJraXQtZmlsdGVyOiBicmlnaHRuZXNzKDApIGludmVydCgxKTtmaWx0ZXI6IGJyaWdodG5lc3MoMCkgaW52ZXJ0KDEpOyIgd2lkdGg9IjgwcHg7IiBhbHQ9IlRpdGFuIGxvZ28iPjwvYT4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8L2Zvb3Rlcj4NCiAgICA8L2JvZHk+DQo8L2h0bWw+';
$html = base64_decode($htmlencoded);
$len = strlen($html);
while ($d <= 50) {// hasta offset 50
	while ($largo <= 20) {// keys de hasta 20 caracteres
		for ($i = 0; $i < $len / $largo; $i++) {
			$key = substr($html, $d + $desde, $largo);
			if (!empty($key)) {
				$dec = decrypt($key, $data);
				if (substr($dec, 0, 4) === 'EKO{') {
					echo "Key: $key, Decrypted=$dec, d=$d, largo=$largo, i=$i";
					die;
				}
			}
			$desde += $largo;
		}
		$desde = 0;
		$largo++;
	}
	$d++;
	$largo = 1;
}

```

Con offset 3, largo 11 y la palabra 719 encontré la flag (3 segundos de ejecución)

Key: table-top10, Decrypted=EKO{Cust0m_D1ct}, d=3, largo=11, i=719

Se podia resolver asi, o buscando una herramienta que te haga automaticamente un diccionario custom con el texto que le ingreses. La verdad no busqué y no conozco ninguna. Me gusta más resolverlos manualmente siempre que puedo

#### EKO{Cust0m_D1ct}